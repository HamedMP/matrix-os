# App Generation Knowledge

## Default: React Modules (~/modules/)

The default output type is a **pre-built React app** using Vite. These are static builds served through the gateway -- no running dev server needed.

### Scaffold Steps

1. Create module directory: `~/modules/<name>/`
2. Write project files (see structure below)
3. Run: `cd ~/modules/<name> && pnpm install && pnpm build`
4. Verify `dist/index.html` exists
5. Register in `~/system/modules.json`

### Structure
```
~/modules/todo-app/
  package.json        # Dependencies + build scripts
  vite.config.ts      # Vite config (React plugin)
  tsconfig.json       # TypeScript config
  index.html          # Vite entry (references src/main.tsx)
  module.json         # Matrix OS module metadata
  src/
    main.tsx          # React entry point
    App.tsx           # Root component
    App.css           # Styles (or use Tailwind)
    components/       # Additional components (if needed)
  dist/               # Build output (generated by pnpm build)
    index.html        # Served by gateway
```

### package.json Template
```json
{
  "name": "@matrixos/todo-app",
  "private": true,
  "type": "module",
  "scripts": {
    "dev": "vite --port 3100",
    "build": "vite build",
    "preview": "vite preview"
  },
  "dependencies": {
    "react": "^19.0.0",
    "react-dom": "^19.0.0"
  },
  "devDependencies": {
    "@types/react": "^19.0.0",
    "@types/react-dom": "^19.0.0",
    "@vitejs/plugin-react": "^4.4.0",
    "typescript": "^5.7.0",
    "vite": "^6.1.0"
  }
}
```

### vite.config.ts Template
```typescript
import { defineConfig } from "vite";
import react from "@vitejs/plugin-react";

export default defineConfig({
  plugins: [react()],
  base: "./",
  build: {
    outDir: "dist",
    emptyOutDir: true,
  },
});
```

### tsconfig.json Template
```json
{
  "compilerOptions": {
    "target": "ES2022",
    "module": "ESNext",
    "moduleResolution": "bundler",
    "jsx": "react-jsx",
    "strict": true,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "outDir": "dist"
  },
  "include": ["src"]
}
```

### index.html Template (Vite entry)
```html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Todo App</title>
</head>
<body>
  <div id="root"></div>
  <script type="module" src="/src/main.tsx"></script>
</body>
</html>
```

### src/main.tsx Template
```tsx
import { StrictMode } from "react";
import { createRoot } from "react-dom/client";
import App from "./App";
import "./App.css";

createRoot(document.getElementById("root")!).render(
  <StrictMode>
    <App />
  </StrictMode>,
);
```

### module.json (Matrix OS metadata)
```json
{
  "name": "todo-app",
  "description": "A simple todo list",
  "version": "1.0.0",
  "entry": "dist/index.html"
}
```

### Theme Integration
Apply theme via CSS custom properties in App.css:
```css
:root {
  --bg: #0a0a0a;
  --fg: #ededed;
  --accent: #6c5ce7;
  --surface: #1a1a2e;
  --border: #2a2a3a;
}

body {
  margin: 0;
  background: var(--bg);
  color: var(--fg);
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
}
```

### Build and Verify
```bash
cd ~/modules/<name>
pnpm install
pnpm build
# Verify dist/index.html exists
ls dist/index.html
```

### Register in modules.json
```json
{
  "name": "todo-app",
  "type": "react-app",
  "path": "~/modules/todo-app",
  "status": "active"
}
```

## HTML Apps (~/apps/) -- Simple Alternative

For very simple tools (calculators, clocks, single-screen utilities), a single HTML file is faster to generate and has zero build step.

### When to Use HTML Apps
- No state management needed
- No component hierarchy
- Single screen, no routing
- User explicitly asks for something "quick" or "simple"

### Structure
- One `.html` file in `~/apps/`
- CSS and JS inline or via CDN imports (esm.sh, unpkg)
- Theme integration: CSS custom properties

### Manifest
```json
{
  "name": "my-app",
  "type": "html-app",
  "path": "~/apps/my-app.html",
  "description": "Short description",
  "status": "active"
}
```

## Decision Guide

| Signal | Output Type |
|--------|------------|
| Default (no preference stated) | React module |
| "build me an app", "create an app" | React module |
| Multiple screens or views | React module |
| State management needed | React module |
| "quick", "simple", "just a..." | HTML app |
| Calculator, clock, single widget | HTML app |

## Best Practices
- Default to React modules -- they scale better and are easier to extend
- Use TypeScript strict mode in all React modules
- Keep components small and focused
- Use semantic HTML and accessible markup
- Make apps responsive
- Always verify the build succeeds before reporting completion
- If build fails, read the error output and fix before retrying
